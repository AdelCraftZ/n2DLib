#include "n2DLib.h"

#define UNUSED(var) (void)var

static unsigned short sprite[] = {
    0x0010,0x0010,0xf81f, // width, height, transparent color
	0xf81f,0xf81f,0xf81f,0xf81f,0xf81f,0x0000,
    0x0000,0x0000,0x0000,0x0000,0x0000,0xf81f,0xf81f,0xf81f,0xf81f,0xf81f,
    0xf81f,0xf81f,0xf81f,0x0000,0x0000,0xd5d5,0xd5d5,0xd5d5,0xd5d5,0xd5d5,
    0xd5d5,0x0000,0x0000,0xf81f,0xf81f,0xf81f,0xf81f,0xf81f,0x0000,0xd5d5,
    0xd5d5,0xd5d5,0xd5d5,0xd5d5,0xd5d5,0xd5d5,0xd5d5,0xd5d5,0xd5d5,0x0000,
    0xf81f,0xf81f,0xf81f,0x0000,0xd5d5,0xd5d5,0x0000,0x0000,0xd5d5,0xd5d5,
    0xd5d5,0xd5d5,0x0000,0x0000,0xd5d5,0xd5d5,0x0000,0xf81f,0xf81f,0x0000,
    0xd5d5,0xd5d5,0x0000,0x0000,0xd5d5,0xd5d5,0xd5d5,0xd5d5,0x0000,0x0000,
    0xd5d5,0xd5d5,0x0000,0xf81f,0x0000,0xd5d5,0xd5d5,0xd5d5,0xd5d5,0xd5d5,
    0xd5d5,0xd5d5,0xd5d5,0xd5d5,0xd5d5,0xd5d5,0xd5d5,0xd5d5,0xd5d5,0x0000,
    0x0000,0xd5d5,0xd5d5,0xd5d5,0xd5d5,0xd5d5,0xd5d5,0xd5d5,0xd5d5,0xd5d5,
    0xd5d5,0xd5d5,0xd5d5,0xd5d5,0xd5d5,0x0000,0x0000,0xd5d5,0xd5d5,0xd5d5,
    0xd5d5,0xd5d5,0xd5d5,0x0000,0xd5d5,0xd5d5,0xd5d5,0xd5d5,0xd5d5,0xd5d5,
    0xd5d5,0x0000,0x0000,0xd5d5,0xd5d5,0xd5d5,0xd5d5,0xd5d5,0xd5d5,0x0000,
    0xd5d5,0xd5d5,0xd5d5,0xd5d5,0xd5d5,0xd5d5,0xd5d5,0x0000,0x0000,0xd5d5,
    0xd5d5,0xd5d5,0xd5d5,0xd5d5,0xd5d5,0xd5d5,0xd5d5,0xd5d5,0xd5d5,0xd5d5,
    0xd5d5,0xd5d5,0xd5d5,0x0000,0x0000,0xd5d5,0xd5d5,0xd5d5,0xd5d5,0xd5d5,
    0xd5d5,0xd5d5,0xd5d5,0xd5d5,0xd5d5,0xd5d5,0xd5d5,0xd5d5,0xd5d5,0x0000,
    0xf81f,0x0000,0xd5d5,0x0000,0xd5d5,0xd5d5,0xd5d5,0xd5d5,0xd5d5,0xd5d5,
    0x0000,0xd5d5,0xd5d5,0xd5d5,0x0000,0xf81f,0xf81f,0x0000,0xd5d5,0xd5d5,
    0x0000,0x0000,0x0000,0x0000,0x0000,0x0000,0xd5d5,0xd5d5,0xd5d5,0xd5d5,
    0x0000,0xf81f,0xf81f,0xf81f,0x0000,0xd5d5,0xd5d5,0xd5d5,0xd5d5,0xd5d5,
    0xd5d5,0xd5d5,0xd5d5,0xd5d5,0xd5d5,0x0000,0xf81f,0xf81f,0xf81f,0xf81f,
    0xf81f,0x0000,0x0000,0xd5d5,0xd5d5,0xd5d5,0xd5d5,0xd5d5,0xd5d5,0x0000,
    0x0000,0xf81f,0xf81f,0xf81f,0xf81f,0xf81f,0xf81f,0xf81f,0xf81f,0x0000,
    0x0000,0x0000,0x0000,0x0000,0x0000,0xf81f,0xf81f,0xf81f,0xf81f,0xf81f
};

int main(int argc, char *argv[])
{
	UNUSED(argc);
	UNUSED(argv);
	Fixed theta = 0;
	Rect spr, nullRect = {0, 0, 0, 0};
	
	int x, y;
	
	initBuffering();
	clearBufferB();
	updateScreen();
	
	spr.x = 160;
	spr.y = 120;
	
	t_key quitKey;
	
	while(!get_key_pressed(&quitKey));
	wait_no_key_pressed();
	
	while(!isKeyPressed(quitKey))
	{
		fillCircle(160, 120, 80, 0xf800);
		fillEllipse(160, 120, 70, 60, 0x001f);
		drawPolygon(0x07e0, 4, 140, 100, 180, 100, 180, 140, 140, 140);
		drawHLine(80, -10, 330, 0xf800);
		drawHLine(160, -10, 330, 0xf800);
		drawVLine(106, -10, 250, 0xf800);
		drawVLine(212, -10, 250, 0xf800);
		
		fillRect(-10, -10, 20, 20, 0xf800);
		fillRect(310, -10, 20, 20, 0x07e0);
		fillRect(310, 230, 20, 20, 0x001f);
		fillRect(-10, 230, 20, 20, 0xffff);
		
		x = 0;
		y = 120;
		
		drawString(&x, &y, x, "ABCDEFGHIJKLMNOPQRSTUVWXYZ\nabcdefghijklmnopqsrtuvwxyz\n0123456789<!%$#>\n", 0, 0xffff);
		drawDecimal(&x, &y, -2134567841, 0x07e0, 0xf800);
		x = 0;
		y += 8;
		drawStringF(&x, &y, x, 0x07e0, 0xf800, "Test ; number : %d\nstring : %s", 42, "the game");
		
		spr.w = theta / 2;
		spr.h = theta / 2;
		drawSpriteScaled(sprite, &spr);
		drawSpriteRotated(sprite, &spr, &nullRect, theta);
		theta++;
		theta &= 255;
		
		updateScreen();
	}
	
	deinitBuffering();
	
	return 0;
}
